<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoanDr. - HECM Reverse Mortgage Comparison</title>

    <!-- Security Headers via Meta Tags -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=()">

    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Page Switcher Tab -->
    <div class="page-switcher">
        <a href="index.html" class="page-tab" data-page="forward">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                <polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            <span>Forward Mortgages</span>
        </a>
        <a href="hecm.html" class="page-tab active" data-page="hecm">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="8" r="5"/>
                <path d="M20 21a8 8 0 0 0-16 0"/>
                <path d="M12 13v8"/>
                <path d="M9 18h6"/>
            </svg>
            <span>Reverse Mortgages (HECM)</span>
        </a>
    </div>

    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-text">
                    <div class="logo">
                        <img src="logo.svg" alt="LoanDr." class="logo-img-header">
                    </div>
                </div>
                <div class="header-actions">
                    <div class="user-info" id="userInfo">
                        <span class="user-name" id="userName"></span>
                        <span class="user-company" id="userCompany"></span>
                    </div>
                    <button class="settings-btn" id="settingsBtn" title="Settings">
                        <svg class="settings-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                        <span class="settings-text">Settings</span>
                    </button>
                    <button class="logout-btn" id="logoutBtn" title="Sign Out">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        <span class="logout-text">Sign Out</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Settings Panel (Slide-out) -->
        <div class="settings-panel hidden" id="settingsPanel">
            <div class="settings-header">
                <h2>Settings</h2>
                <button class="close-settings" id="closeSettings">&times;</button>
            </div>

            <div class="settings-body">
                <!-- Appearance Settings -->
                <div class="settings-section">
                    <h3>Appearance</h3>
                    <p class="settings-note">Customize the look and feel of the application</p>

                    <div class="branding-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkModeToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-text">Dark Mode</span>
                    </div>
                </div>

                <!-- Account Info -->
                <div class="settings-section">
                    <h3>My Account</h3>
                    <p class="settings-note">Your information for documents and contact details</p>

                    <div class="settings-form">
                        <div class="form-group">
                            <label>Your Name</label>
                            <input type="text" id="loName" placeholder="John Smith">
                        </div>
                        <div class="form-group">
                            <label>Company Name</label>
                            <input type="text" id="loCompany" placeholder="ABC Mortgage">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="loPhone" placeholder="(555) 123-4567">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="loEmail" placeholder="john@abcmortgage.com">
                        </div>
                        <div class="form-group">
                            <label>NMLS #</label>
                            <input type="text" id="loNMLS" placeholder="123456">
                        </div>
                    </div>

                    <button class="save-settings-btn" id="saveLOSettings">Save Loan Officer Info</button>
                </div>

                <!-- Lender Information -->
                <div class="settings-section">
                    <h3>Lender Information</h3>
                    <p class="settings-note">Enter your lending institution's details for documents and branding</p>

                    <div class="settings-form">
                        <div class="form-group">
                            <label>Lender Name</label>
                            <input type="text" id="lenderName" placeholder="First National Bank">
                        </div>
                        <div class="form-group">
                            <label>Lender NMLS #</label>
                            <input type="text" id="lenderNMLS" placeholder="123456">
                        </div>
                        <div class="form-group">
                            <label>Main Phone</label>
                            <input type="tel" id="lenderPhone" placeholder="(800) 555-1234">
                        </div>
                        <div class="form-group">
                            <label>Website</label>
                            <input type="url" id="lenderWebsite" placeholder="www.firstnationalbank.com">
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <input type="text" id="lenderAddress" placeholder="123 Main Street, Suite 100">
                        </div>
                        <div class="form-group">
                            <label>City, State ZIP</label>
                            <input type="text" id="lenderCityStateZip" placeholder="New York, NY 10001">
                        </div>
                        <div class="form-group full-width">
                            <label>Equal Housing Lender Statement</label>
                            <textarea id="lenderDisclaimer" rows="2" placeholder="Equal Housing Lender. NMLS# 123456"></textarea>
                        </div>
                    </div>

                    <button class="save-settings-btn" id="saveLenderSettings">Save Lender Info</button>
                </div>

                <!-- Dual Branding - Real Estate Agent -->
                <div class="settings-section">
                    <h3>Real Estate Agent (Dual Branding)</h3>
                    <p class="settings-note">Add a real estate agent's info to appear on generated documents</p>

                    <div class="branding-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="enableRealtorBranding">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-text">Include on documents</span>
                    </div>

                    <div class="settings-form" id="realtorForm">
                        <div class="form-group">
                            <label>Agent Name</label>
                            <input type="text" id="realtorName" placeholder="Jane Doe">
                        </div>
                        <div class="form-group">
                            <label>Brokerage/Company</label>
                            <input type="text" id="realtorCompany" placeholder="ABC Realty">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="realtorPhone" placeholder="(555) 987-6543">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="realtorEmail" placeholder="jane@abcrealty.com">
                        </div>
                        <div class="form-group">
                            <label>License #</label>
                            <input type="text" id="realtorLicense" placeholder="RE-123456">
                        </div>
                    </div>

                    <button class="save-settings-btn" id="saveRealtorSettings">Save Real Estate Agent Info</button>
                </div>

                <!-- Dual Branding - Title Company/Agent -->
                <div class="settings-section">
                    <h3>Title Company/Agent (Dual Branding)</h3>
                    <p class="settings-note">Add a title company or settlement agent's info to appear on generated documents</p>

                    <div class="branding-toggle">
                        <label class="toggle-switch">
                            <input type="checkbox" id="enableTitleBranding">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-text">Include on documents</span>
                    </div>

                    <div class="settings-form" id="titleAgentForm">
                        <div class="form-group">
                            <label>Company Name</label>
                            <input type="text" id="titleAgentCompany" placeholder="First American Title">
                        </div>
                        <div class="form-group">
                            <label>Contact Name</label>
                            <input type="text" id="titleAgentName" placeholder="John Smith">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="titleAgentPhone" placeholder="(555) 456-7890">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="titleAgentEmail" placeholder="john@firstamerican.com">
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <input type="text" id="titleAgentAddress" placeholder="123 Main St, City, ST 12345">
                        </div>
                    </div>

                    <button class="save-settings-btn" id="saveTitleAgentSettings">Save Title Company Info</button>
                </div>

                <!-- Help & Support Section -->
                <div class="settings-section help-section">
                    <h3>Help & Support</h3>
                    <p class="settings-note">Get help using LoanDr. or contact us with questions</p>

                    <div class="help-links">
                        <a href="help.html" class="help-center-link">
                            <svg class="help-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>
                            <div class="help-link-content">
                                <strong>Help Center</strong>
                                <span>Guides, FAQs, glossary, and tutorials</span>
                            </div>
                            <svg class="arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                        </a>
                        <a href="help.html#contact" class="help-center-link">
                            <svg class="help-icon" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                            <div class="help-link-content">
                                <strong>Contact Support</strong>
                                <span>Send us a message</span>
                            </div>
                            <svg class="arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"/></svg>
                        </a>
                    </div>

                    <div class="help-version">
                        <small>LoanDr. v1.0 | Made for Loan Officers</small>
                    </div>
                </div>

                <!-- Admin Section -->
                <div class="settings-section admin-section">
                    <h3>Administrator</h3>
                    <p class="settings-note">Access admin dashboard to view all collected data</p>

                    <div class="admin-login-form" id="adminLoginForm">
                        <div class="form-group">
                            <label>Admin Password</label>
                            <input type="password" id="adminPassword" placeholder="Enter admin password">
                        </div>
                        <button class="admin-login-btn" id="adminLoginBtn">Sign In as Admin</button>
                        <p class="admin-error hidden" id="adminError">Incorrect password</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="settings-overlay hidden" id="settingsOverlay"></div>

        <!-- HECM Info Banner -->
        <div class="hecm-info-banner">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <line x1="12" y1="16" x2="12" y2="12"/>
                <line x1="12" y1="8" x2="12.01" y2="8"/>
            </svg>
            <div>
                <strong>HECM Reverse Mortgage Comparison</strong>
                <p>Compare Home Equity Conversion Mortgage options for borrowers 62 and older</p>
            </div>
        </div>

        <!-- Scenario Tabs -->
        <div class="loan-tabs-container">
            <div class="loan-tabs" id="hecmTabs">
                <button class="loan-tab active" data-loan="1">
                    <span class="tab-name">Scenario 1</span>
                    <span class="remove-loan" title="Remove scenario">&times;</span>
                </button>
                <button class="loan-tab" data-loan="2">
                    <span class="tab-name">Scenario 2</span>
                    <span class="remove-loan" title="Remove scenario">&times;</span>
                </button>
            </div>
            <button class="add-loan-btn" id="addHecmBtn" title="Add Scenario">
                <span class="plus-icon">+</span>
            </button>
            <div class="scenario-actions">
                <button class="scenario-action-btn my-scenarios-btn" id="myScenariosBtn" title="View and manage saved scenarios">
                    My Scenarios
                </button>
                <button class="scenario-action-btn save-btn" id="saveScenarioBtn" title="Save current scenarios">
                    Save
                </button>
                <button class="scenario-action-btn export-btn" id="exportDataBtn" title="Download to file">
                    Export
                </button>
                <label class="scenario-action-btn import-btn" title="Import from file">
                    Import
                    <input type="file" id="importDataInput" accept=".json,.hecm" style="display: none;">
                </label>
            </div>
        </div>

        <!-- HECM Panels -->
        <div class="loan-panels" id="hecmPanels">
            <!-- Scenario 1 -->
            <div class="loan-panel active" data-panel="1">
                <!-- Scenario Name -->
                <div class="scenario-name-section">
                    <div class="form-group">
                        <label>Scenario Name</label>
                        <input type="text" class="scenario-name" placeholder="e.g., Fixed Rate HECM">
                    </div>
                </div>

                <!-- HECM Type Toggle -->
                <div class="hecm-type-tabs">
                    <button class="hecm-type-tab active" data-type="fixed">Fixed Rate</button>
                    <button class="hecm-type-tab" data-type="adjustable">Adjustable Rate</button>
                </div>

                <div class="hecm-form-grid">
                    <!-- Borrower Information -->
                    <div class="form-section">
                        <h3>Borrower Information</h3>
                        <div class="form-group">
                            <label>Youngest Borrower Age</label>
                            <input type="number" class="borrower-age" min="62" max="100" value="70" placeholder="62+">
                            <span class="helper-text">Must be 62 or older for HECM</span>
                        </div>
                        <div class="form-group">
                            <label>Eligible Non-Borrowing Spouse Age (if applicable)</label>
                            <input type="number" class="spouse-age" min="18" max="100" placeholder="Optional">
                        </div>
                    </div>

                    <!-- Property Information -->
                    <div class="form-section">
                        <h3>Property Information</h3>
                        <div class="form-group">
                            <label>Property Value (Appraised)</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="home-value" value="450000" placeholder="450,000">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Property Type</label>
                            <select class="property-type">
                                <option value="single-family">Single Family Home</option>
                                <option value="condo">FHA-Approved Condo</option>
                                <option value="townhouse">Townhouse</option>
                                <option value="2-4-unit">2-4 Unit (owner-occupied)</option>
                                <option value="manufactured">Manufactured Home (1976+)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Existing Mortgage Balance</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="existing-mortgage" value="75000" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <!-- HECM Loan Details -->
                    <div class="form-section">
                        <h3>HECM Loan Details</h3>
                        <div class="form-group">
                            <label>Expected Interest Rate</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="interest-rate" step="0.125" value="6.50" placeholder="6.50">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group adjustable-only" style="display: none;">
                            <label>Initial Rate (Adjustable)</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="initial-rate" step="0.125" value="5.50" placeholder="5.50">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Margin (Adjustable HECMs)</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="margin" step="0.125" value="2.00" placeholder="2.00">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Lender Credit / Origination</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="lender-credit" value="0" placeholder="0">
                            </div>
                            <span class="helper-text">Negative = lender credit, Positive = origination fee</span>
                        </div>
                    </div>

                    <!-- Principal Limit Factors -->
                    <div class="form-section">
                        <h3>Principal Limit</h3>
                        <div class="form-group">
                            <label>FHA Lending Limit (2024)</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="fha-limit" value="1149825" readonly>
                            </div>
                            <span class="helper-text">Current FHA maximum claim amount</span>
                        </div>
                        <div class="form-group">
                            <label>Principal Limit Factor (PLF)</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="plf" step="0.1" value="52.4" placeholder="Based on age/rate">
                                <span class="percent-symbol">%</span>
                            </div>
                            <span class="helper-text">Based on age and expected rate</span>
                        </div>
                    </div>

                    <!-- Payment Options -->
                    <div class="form-section full-width">
                        <h3>Payment Option</h3>
                        <div class="payment-options">
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="lump-sum" checked>
                                <span class="option-content">
                                    <strong>Lump Sum</strong>
                                    <small>Single disbursement at closing (Fixed rate only)</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="line-of-credit">
                                <span class="option-content">
                                    <strong>Line of Credit</strong>
                                    <small>Draw funds as needed, unused portion grows</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="tenure">
                                <span class="option-content">
                                    <strong>Tenure</strong>
                                    <small>Equal monthly payments for life</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="term">
                                <span class="option-content">
                                    <strong>Term</strong>
                                    <small>Equal monthly payments for set period</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="modified-tenure">
                                <span class="option-content">
                                    <strong>Modified Tenure</strong>
                                    <small>Line of credit + monthly payments for life</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-1" value="modified-term">
                                <span class="option-content">
                                    <strong>Modified Term</strong>
                                    <small>Line of credit + monthly payments for set period</small>
                                </span>
                            </label>
                        </div>
                        <div class="term-period-group" style="display: none;">
                            <label>Payment Term (months)</label>
                            <input type="number" class="term-months" min="1" max="360" value="120" placeholder="120">
                        </div>
                    </div>

                    <!-- Closing Costs -->
                    <div class="form-section full-width">
                        <h3>Estimated Closing Costs</h3>
                        <div class="hecm-costs-grid">
                            <div class="form-group">
                                <label>Initial MIP (2%)</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="initial-mip" readonly>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Origination Fee</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="origination-fee" readonly>
                                </div>
                                <span class="helper-text">Max $6,000 (capped by FHA)</span>
                            </div>
                            <div class="form-group">
                                <label>Third Party Costs</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="third-party-costs" value="3500" placeholder="3,500">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Total Closing Costs</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="total-closing-costs" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Calculate Button -->
                <button class="calculate-btn" onclick="HECMCalculator.calculate(1)">
                    Calculate HECM Benefits
                </button>

                <!-- Results Section -->
                <div class="results-section hecm-results" id="results-1" style="display: none;">
                    <h2>HECM Analysis Results</h2>

                    <div class="results-grid hecm-results-grid">
                        <div class="result-card primary">
                            <h4>Maximum Claim Amount</h4>
                            <div class="result-value" id="max-claim-1">$0</div>
                            <small>Lesser of home value or FHA limit</small>
                        </div>
                        <div class="result-card primary">
                            <h4>Principal Limit</h4>
                            <div class="result-value" id="principal-limit-1">$0</div>
                            <small>Total available based on PLF</small>
                        </div>
                        <div class="result-card">
                            <h4>Net Principal Limit</h4>
                            <div class="result-value" id="net-principal-1">$0</div>
                            <small>After closing costs & payoffs</small>
                        </div>
                        <div class="result-card">
                            <h4>Cash to Borrower</h4>
                            <div class="result-value" id="cash-to-borrower-1">$0</div>
                            <small>Available funds at closing</small>
                        </div>
                        <div class="result-card">
                            <h4>Line of Credit</h4>
                            <div class="result-value" id="loc-amount-1">$0</div>
                            <small>Initial available credit</small>
                        </div>
                        <div class="result-card">
                            <h4>Monthly Payment</h4>
                            <div class="result-value" id="monthly-payment-1">$0</div>
                            <small>Tenure/Term payment amount</small>
                        </div>
                    </div>

                    <!-- Line of Credit Growth -->
                    <div class="loc-growth-section">
                        <h3>Line of Credit Growth Projection</h3>
                        <p class="section-note">Unused line of credit grows at the same rate as the loan balance</p>
                        <div class="loc-growth-grid">
                            <div class="growth-item">
                                <span class="growth-year">Year 5</span>
                                <span class="growth-value" id="loc-year5-1">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 10</span>
                                <span class="growth-value" id="loc-year10-1">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 15</span>
                                <span class="growth-value" id="loc-year15-1">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 20</span>
                                <span class="growth-value" id="loc-year20-1">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Loan Balance Projection -->
                    <div class="balance-projection-section">
                        <h3>Loan Balance Projection</h3>
                        <p class="section-note">Estimated loan balance over time (including 0.5% annual MIP)</p>
                        <div class="balance-grid">
                            <div class="balance-item">
                                <span class="balance-year">Year 5</span>
                                <span class="balance-value" id="balance-year5-1">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 10</span>
                                <span class="balance-value" id="balance-year10-1">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 15</span>
                                <span class="balance-value" id="balance-year15-1">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 20</span>
                                <span class="balance-value" id="balance-year20-1">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Cost Breakdown -->
                    <div class="hecm-cost-breakdown">
                        <h3>Upfront Costs Breakdown</h3>
                        <div class="cost-items">
                            <div class="cost-item">
                                <span>Initial MIP (2%)</span>
                                <span id="cost-mip-1">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Origination Fee</span>
                                <span id="cost-origination-1">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Third Party Costs</span>
                                <span id="cost-third-party-1">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Existing Mortgage Payoff</span>
                                <span id="cost-payoff-1">$0</span>
                            </div>
                            <div class="cost-item total">
                                <span>Total Deductions</span>
                                <span id="cost-total-1">$0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scenario 2 -->
            <div class="loan-panel" data-panel="2">
                <!-- Same structure as Scenario 1 -->
                <div class="scenario-name-section">
                    <div class="form-group">
                        <label>Scenario Name</label>
                        <input type="text" class="scenario-name" placeholder="e.g., Adjustable Rate HECM">
                    </div>
                </div>

                <div class="hecm-type-tabs">
                    <button class="hecm-type-tab" data-type="fixed">Fixed Rate</button>
                    <button class="hecm-type-tab active" data-type="adjustable">Adjustable Rate</button>
                </div>

                <div class="hecm-form-grid">
                    <!-- Borrower Information -->
                    <div class="form-section">
                        <h3>Borrower Information</h3>
                        <div class="form-group">
                            <label>Youngest Borrower Age</label>
                            <input type="number" class="borrower-age" min="62" max="100" value="70" placeholder="62+">
                            <span class="helper-text">Must be 62 or older for HECM</span>
                        </div>
                        <div class="form-group">
                            <label>Eligible Non-Borrowing Spouse Age (if applicable)</label>
                            <input type="number" class="spouse-age" min="18" max="100" placeholder="Optional">
                        </div>
                    </div>

                    <!-- Property Information -->
                    <div class="form-section">
                        <h3>Property Information</h3>
                        <div class="form-group">
                            <label>Property Value (Appraised)</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="home-value" value="450000" placeholder="450,000">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Property Type</label>
                            <select class="property-type">
                                <option value="single-family">Single Family Home</option>
                                <option value="condo">FHA-Approved Condo</option>
                                <option value="townhouse">Townhouse</option>
                                <option value="2-4-unit">2-4 Unit (owner-occupied)</option>
                                <option value="manufactured">Manufactured Home (1976+)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Existing Mortgage Balance</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="existing-mortgage" value="75000" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <!-- HECM Loan Details -->
                    <div class="form-section">
                        <h3>HECM Loan Details</h3>
                        <div class="form-group">
                            <label>Expected Interest Rate</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="interest-rate" step="0.125" value="7.00" placeholder="7.00">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group adjustable-only">
                            <label>Initial Rate (Adjustable)</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="initial-rate" step="0.125" value="6.00" placeholder="6.00">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Margin</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="margin" step="0.125" value="2.00" placeholder="2.00">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Lender Credit / Origination</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="lender-credit" value="0" placeholder="0">
                            </div>
                        </div>
                    </div>

                    <!-- Principal Limit Factors -->
                    <div class="form-section">
                        <h3>Principal Limit</h3>
                        <div class="form-group">
                            <label>FHA Lending Limit (2024)</label>
                            <div class="input-wrapper">
                                <span class="currency-symbol">$</span>
                                <input type="number" class="fha-limit" value="1149825" readonly>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Principal Limit Factor (PLF)</label>
                            <div class="input-wrapper percent-wrapper">
                                <input type="number" class="plf" step="0.1" value="48.7" placeholder="Based on age/rate">
                                <span class="percent-symbol">%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Options -->
                    <div class="form-section full-width">
                        <h3>Payment Option</h3>
                        <div class="payment-options">
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="lump-sum">
                                <span class="option-content">
                                    <strong>Lump Sum</strong>
                                    <small>Single disbursement at closing</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="line-of-credit" checked>
                                <span class="option-content">
                                    <strong>Line of Credit</strong>
                                    <small>Draw funds as needed, unused portion grows</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="tenure">
                                <span class="option-content">
                                    <strong>Tenure</strong>
                                    <small>Equal monthly payments for life</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="term">
                                <span class="option-content">
                                    <strong>Term</strong>
                                    <small>Equal monthly payments for set period</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="modified-tenure">
                                <span class="option-content">
                                    <strong>Modified Tenure</strong>
                                    <small>Line of credit + monthly payments for life</small>
                                </span>
                            </label>
                            <label class="payment-option">
                                <input type="radio" name="payment-type-2" value="modified-term">
                                <span class="option-content">
                                    <strong>Modified Term</strong>
                                    <small>Line of credit + monthly payments for set period</small>
                                </span>
                            </label>
                        </div>
                        <div class="term-period-group" style="display: none;">
                            <label>Payment Term (months)</label>
                            <input type="number" class="term-months" min="1" max="360" value="120" placeholder="120">
                        </div>
                    </div>

                    <!-- Closing Costs -->
                    <div class="form-section full-width">
                        <h3>Estimated Closing Costs</h3>
                        <div class="hecm-costs-grid">
                            <div class="form-group">
                                <label>Initial MIP (2%)</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="initial-mip" readonly>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Origination Fee</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="origination-fee" readonly>
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Third Party Costs</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="third-party-costs" value="3500" placeholder="3,500">
                                </div>
                            </div>
                            <div class="form-group">
                                <label>Total Closing Costs</label>
                                <div class="input-wrapper">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" class="total-closing-costs" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <button class="calculate-btn" onclick="HECMCalculator.calculate(2)">
                    Calculate HECM Benefits
                </button>

                <!-- Results Section for Scenario 2 -->
                <div class="results-section hecm-results" id="results-2" style="display: none;">
                    <h2>HECM Analysis Results</h2>
                    <div class="results-grid hecm-results-grid">
                        <div class="result-card primary">
                            <h4>Maximum Claim Amount</h4>
                            <div class="result-value" id="max-claim-2">$0</div>
                            <small>Lesser of home value or FHA limit</small>
                        </div>
                        <div class="result-card primary">
                            <h4>Principal Limit</h4>
                            <div class="result-value" id="principal-limit-2">$0</div>
                            <small>Total available based on PLF</small>
                        </div>
                        <div class="result-card">
                            <h4>Net Principal Limit</h4>
                            <div class="result-value" id="net-principal-2">$0</div>
                            <small>After closing costs & payoffs</small>
                        </div>
                        <div class="result-card">
                            <h4>Cash to Borrower</h4>
                            <div class="result-value" id="cash-to-borrower-2">$0</div>
                            <small>Available funds at closing</small>
                        </div>
                        <div class="result-card">
                            <h4>Line of Credit</h4>
                            <div class="result-value" id="loc-amount-2">$0</div>
                            <small>Initial available credit</small>
                        </div>
                        <div class="result-card">
                            <h4>Monthly Payment</h4>
                            <div class="result-value" id="monthly-payment-2">$0</div>
                            <small>Tenure/Term payment amount</small>
                        </div>
                    </div>

                    <div class="loc-growth-section">
                        <h3>Line of Credit Growth Projection</h3>
                        <p class="section-note">Unused line of credit grows at the same rate as the loan balance</p>
                        <div class="loc-growth-grid">
                            <div class="growth-item">
                                <span class="growth-year">Year 5</span>
                                <span class="growth-value" id="loc-year5-2">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 10</span>
                                <span class="growth-value" id="loc-year10-2">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 15</span>
                                <span class="growth-value" id="loc-year15-2">$0</span>
                            </div>
                            <div class="growth-item">
                                <span class="growth-year">Year 20</span>
                                <span class="growth-value" id="loc-year20-2">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="balance-projection-section">
                        <h3>Loan Balance Projection</h3>
                        <p class="section-note">Estimated loan balance over time (including 0.5% annual MIP)</p>
                        <div class="balance-grid">
                            <div class="balance-item">
                                <span class="balance-year">Year 5</span>
                                <span class="balance-value" id="balance-year5-2">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 10</span>
                                <span class="balance-value" id="balance-year10-2">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 15</span>
                                <span class="balance-value" id="balance-year15-2">$0</span>
                            </div>
                            <div class="balance-item">
                                <span class="balance-year">Year 20</span>
                                <span class="balance-value" id="balance-year20-2">$0</span>
                            </div>
                        </div>
                    </div>

                    <div class="hecm-cost-breakdown">
                        <h3>Upfront Costs Breakdown</h3>
                        <div class="cost-items">
                            <div class="cost-item">
                                <span>Initial MIP (2%)</span>
                                <span id="cost-mip-2">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Origination Fee</span>
                                <span id="cost-origination-2">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Third Party Costs</span>
                                <span id="cost-third-party-2">$0</span>
                            </div>
                            <div class="cost-item">
                                <span>Existing Mortgage Payoff</span>
                                <span id="cost-payoff-2">$0</span>
                            </div>
                            <div class="cost-item total">
                                <span>Total Deductions</span>
                                <span id="cost-total-2">$0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Side by Side Comparison -->
        <div class="hecm-comparison-section" id="hecmComparison" style="display: none;">
            <h2>HECM Comparison</h2>
            <div class="comparison-table-container">
                <table class="comparison-table hecm-comparison-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                            <th id="compare-name-1">Scenario 1</th>
                            <th id="compare-name-2">Scenario 2</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody id="hecmComparisonBody">
                        <!-- Populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Document Generation -->
        <div class="document-actions">
            <button type="button" class="generate-doc-btn" id="generateHecmDoc">
                <svg class="doc-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                Generate HECM Comparison Document
            </button>
            <button type="button" class="print-btn" id="printHecmBtn">
                <svg class="doc-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
                Print Comparison
            </button>
        </div>
    </div>

    <!-- Document Preview Modal -->
    <div class="modal-overlay hidden" id="documentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>HECM Comparison Document</h2>
                <button class="modal-close" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="document-options">
                    <div class="form-group">
                        <label>Borrower Name(s)</label>
                        <input type="text" id="borrowerName" placeholder="Enter borrower name(s)">
                    </div>
                    <div class="form-group">
                        <label>Property Address</label>
                        <input type="text" id="propertyAddress" placeholder="Enter property address">
                    </div>
                    <div class="form-group">
                        <label>Loan Officer Name</label>
                        <input type="text" id="loanOfficerName" placeholder="Your name">
                    </div>
                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" id="companyName" placeholder="Your company">
                    </div>
                    <div class="form-group">
                        <label>Contact Information</label>
                        <input type="text" id="contactInfo" placeholder="Phone/Email">
                    </div>
                    <div class="form-group">
                        <label>Additional Notes</label>
                        <textarea id="additionalNotes" rows="3" placeholder="Any additional notes for the borrower..."></textarea>
                    </div>
                </div>
                <div class="document-preview" id="documentPreview">
                    <!-- Document preview generated by JS -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="copyDocBtn">Copy to Clipboard</button>
                <button class="btn-primary" id="downloadDocBtn">Download as HTML</button>
                <button class="btn-primary" id="printDocBtn">Print Document</button>
            </div>
        </div>
    </div>

    <!-- Save/Load Scenarios Modal -->
    <div class="saved-scenarios-modal hidden" id="savedScenariosModal">
        <div class="saved-scenarios-content">
            <div class="saved-scenarios-header">
                <h3>Saved HECM Scenarios</h3>
                <button class="close-saved-btn" id="closeSavedModal">&times;</button>
            </div>
            <div class="saved-scenarios-body">
                <div class="saved-list" id="savedScenariosList">
                    <!-- Populated by JS -->
                </div>
                <div class="save-new-section">
                    <h4>Save Current Session</h4>
                    <div class="save-input-row">
                        <input type="text" id="saveScenarioName" placeholder="Enter a name for this comparison...">
                        <button class="btn-save-new" id="saveNewScenarioBtn">Save</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="saved-scenarios-overlay hidden" id="savedScenariosOverlay"></div>

    <script src="hecm-script.js"></script>
</body>
</html>
